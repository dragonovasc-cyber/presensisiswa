<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Database Siswa Dragonova</title>
  <style>
    body { font-family: book antiqua, serif; margin: 20px; }
    select { padding: 5px; }
    .card {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #f9f9f9;
    }
    .card a { color: blue; text-decoration: underline; }
  </style>
</head>
<body>
  <h2>Database Siswa Dragonova</h2>

  <label for="siswa">Pilih Nama Siswa:</label>
  <select id="siswa"></select>

  <div id="detail" class="card"></div>

  <script>
    // Ganti dengan link CSV Google Sheet kamu
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTUO3nqT6Brk_zw6Gd3NhSNqJhzgo_UC2eAQ7HLGrvXL2cpD6E9funEbmEMjG6GjP7fQG1g7ToxCKpU/pub?gid=2060708038&single=true&output=csv";

    async function loadCSV() {
      const response = await fetch(csvUrl);
      const data = await response.text();

      const rows = data.split("\n").map(r => r.split(","));
      const headers = rows[0]; // baris header (No ID, Nama Lengkap, Tanggal Lahir, Link Presensi)
      const siswaData = rows.slice(1); // isi data

      const select = document.getElementById("siswa");
      const detail = document.getElementById("detail");

      // Isi dropdown dengan nama siswa
      siswaData.forEach(row => {
        if (row[1]) { // kolom Nama Lengkap
          const option = document.createElement("option");
          option.value = row[0]; // No ID
          option.textContent = row[1]; // Nama Lengkap
          select.appendChild(option);
        }
      });

      // Event saat ganti pilihan
      select.addEventListener("change", () => {
        const id = select.value;
        const row = siswaData.find(r => r[0] === id);
        if (row) {
          detail.innerHTML = `
            <h3>${row[1]}</h3>
            <p><b>No ID:</b> ${row[0]}</p>
            <p><b>Tanggal Lahir:</b> ${row[2]}</p>
            <p><b>Link Presensi:</b> <a href="${row[3]}" target="_blank">Klik di sini</a></p>
          `;
        }
      });

      // Tampilkan data pertama kali
      select.dispatchEvent(new Event("change"));
    }

    loadCSV();
  </script>
</body>
</html>

